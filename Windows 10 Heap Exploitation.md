Windows 10 Heap Exploitation
=========================
NT Heap allocator
--------------------------------------------
1. Heap
    1. Full Binary Tree
    2. 필요에 따라 할당받을 수 있는 메모리
2. Heap allocator
    1. fagmentation
        1. Internal Fragmentation
        2. External Fragmentation
3. Glibc malloc, Tcmalloc, Jemalloc, NT malloc(Windows), Segment heap(Windows 10)
    1. NT Heap
        1. 윈도우의 기본 힙할당자
        2. Back-end
        3. Front-end
            1. LAL(Look aside list)
            2. LFH(Low Fragmentation Heap)
    2. Segment Heap
        1. 윈도우 10
4. DIve into NT Heap
    1. _HEAP
        1. EncodeFlagMask -> chunk의 checksum
        2. Blocksindex -> Free list의 탐색효율성
    2. _HEAP_ENTRY
        1. Inuse
            1. Linux Heap이랑 비슷함
        2. Freed
            1. Linux Heap이랑 비슷함
        3. VirtualAlloc'd
            1. Mmapped 같은 거 인듯?
    3. _BlocksIndex
    ***
    1. Alloc
        1. Size <= 0x4000
            <br/>-> 리눅스에서 Fast bin 처리하는 거처럼 처리하는 듯
    2. Free
        1. Size <= 0xff000
            1. allign check
            2. if LFH is deactivated FrontEndHeapUsageData -= 1
            3. check is freed
            4. insert into freed list
            5. check is validate (even if it does not pass test process is kept)
5. Unsafe Unlink
    1. 조건
        1. Heap 영역이 전역변수
        2. Use after Free
        3. Header 조작 필요 없음, uaf 되는 청크의 앞 청크를 free 해야함
        4. Non-debug 모드에서만 가능
    2. glibc unsafe unlink와 비슷하게 전역변수영역을 적당히 주작함
6. LFH
    1. malloc을 연속적으로 해주지 않음